<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <title>H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng K-UTILS PRO v2.2</title>
    <meta name="description" content="Add-in Excel mi·ªÖn ph√≠: ƒê·ªçc s·ªë th√†nh ch·ªØ, T·ª∑ gi√° VCB, Tra c·ª©u MST, G·ªôp file, G·ª≠i Email l∆∞∆°ng.">
    
    <link rel="icon" href="setup_icon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="setup_icon.ico" type="image/x-icon">

    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary: #2563eb;
            --primary-hover: #1d4ed8;
            --bg-body: #f8fafc;
            --bg-card: #ffffff;
            --text-main: #1e293b;
            --text-muted: #64748b;
            --border: #e2e8f0;
            --sidebar-width: 280px;
            --techcom-red: #e30613;
            --donate-bg: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
        }

        [data-theme="dark"] {
            --bg-body: #0f172a;
            --bg-card: #1e293b;
            --text-main: #f1f5f9;
            --text-muted: #94a3b8;
            --border: #334155;
            --donate-bg: linear-gradient(135deg, #1e293b 0%, #0f172a 100%);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg-body); color: var(--text-main); line-height: 1.6; display: flex; min-height: 100vh; transition: background 0.3s; }

        /* SIDEBAR */
        .sidebar { width: var(--sidebar-width); background-color: var(--bg-card); border-right: 1px solid var(--border); position: fixed; height: 100vh; overflow-y: auto; padding: 20px; z-index: 100; transition: transform 0.3s; }
        
        /* LOGO STYLE CU (Dep & Don gian) */
        .logo { font-size: 24px; font-weight: 800; color: var(--primary); margin-bottom: 30px; display: flex; align-items: center; gap: 10px; }
        
        .nav-menu { list-style: none; }
        .nav-item { margin-bottom: 5px; }
        .nav-link { display: flex; align-items: center; gap: 10px; padding: 10px 15px; color: var(--text-muted); text-decoration: none; border-radius: 8px; font-weight: 500; transition: all 0.2s; }
        .nav-link:hover, .nav-link.active { background-color: rgba(37, 99, 235, 0.1); color: var(--primary); }
        .nav-link i { width: 20px; text-align: center; }

        /* MAIN CONTENT */
        .main-content { margin-left: var(--sidebar-width); flex: 1; padding: 40px; max-width: 1200px; }
        section { margin-bottom: 60px; scroll-margin-top: 80px; }
        h1 { font-size: 32px; margin-bottom: 15px; color: var(--text-main); }
        h2 { font-size: 24px; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid var(--border); color: var(--primary); display: flex; align-items: center; gap: 10px; }
        h3 { font-size: 18px; margin: 25px 0 10px; font-weight: 600; color: var(--text-main); }
        p, li { color: var(--text-muted); margin-bottom: 10px; }
        
        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .feature-card { background: var(--bg-card); border: 1px solid var(--border); padding: 20px; border-radius: 12px; transition: transform 0.2s; }
        .feature-card:hover { transform: translateY(-3px); border-color: var(--primary); }
        .feature-icon { font-size: 24px; color: var(--primary); margin-bottom: 15px; }

        .download-btn { display: inline-flex; align-items: center; justify-content: center; gap: 10px; background-color: var(--primary); color: white; padding: 12px 30px; border-radius: 30px; text-decoration: none; font-weight: 700; margin-top: 15px; transition: background 0.2s, transform 0.2s; box-shadow: 0 4px 15px rgba(37, 99, 235, 0.2); }
        .download-btn:hover { background-color: var(--primary-hover); transform: translateY(-2px); }

        .donate-wrapper { background: var(--donate-bg); border-radius: 16px; padding: 40px; text-align: center; border: 1px solid var(--border); box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        .bank-card { background: #ffffff; width: 100%; max-width: 400px; margin: 20px auto; border-radius: 16px; padding: 25px; box-shadow: 0 4px 20px rgba(0,0,0,0.1); text-align: left; position: relative; border-left: 6px solid var(--techcom-red); color: #333; }
        .bank-logo { font-weight: 900; color: var(--techcom-red); font-size: 22px; margin-bottom: 20px; display: block; }
        .account-number { font-size: 28px; font-family: monospace; font-weight: 700; color: #333; letter-spacing: 2px; margin-bottom: 5px; }
        .account-name { font-size: 16px; text-transform: uppercase; color: #666; font-weight: 600; }
        
        .copy-btn { background: #f1f5f9; border: 1px solid #e2e8f0; color: #333; padding: 8px 15px; border-radius: 6px; cursor: pointer; font-size: 12px; float: right; margin-top: -45px; transition: 0.2s; }
        .copy-btn:hover { background: var(--primary); color: white; border-color: var(--primary); }

        .badge { background: #dbeafe; color: #1e40af; padding: 4px 8px; border-radius: 4px; font-size: 12px; font-weight: 600; }
        code { background: var(--bg-card); border: 1px solid var(--border); padding: 2px 6px; border-radius: 4px; font-family: monospace; font-size: 0.9em; color: #e11d48; }
        
        .controls { position: fixed; top: 20px; right: 20px; display: flex; gap: 10px; z-index: 101; }
        .control-btn { background: var(--bg-card); border: 1px solid var(--border); padding: 10px 15px; border-radius: 30px; cursor: pointer; box-shadow: 0 2px 10px rgba(0,0,0,0.1); font-weight: 600; color: var(--text-main); display: flex; align-items: center; gap: 5px; }
        .control-btn:hover { background: var(--border); }
        .lang-en { display: none; }

        @media (max-width: 768px) {
            .sidebar { transform: translateX(-100%); }
            .sidebar.active { transform: translateX(0); }
            .main-content { margin-left: 0; padding: 20px; padding-top: 80px;}
            .grid-2 { grid-template-columns: 1fr; }
            .controls { top: 10px; right: 10px; }
        }
    </style>
</head>

<body>
    <div class="controls">
        <button class="control-btn" onclick="toggleLanguage()"><span id="lang-icon">üá∫üá∏</span> <span id="lang-text">EN</span></button>
        <button class="control-btn" onclick="toggleTheme()"><i class="fas fa-moon" id="theme-icon"></i></button>
    </div>

    <aside class="sidebar">
        <div class="logo">
            <i class="fas fa-layer-group"></i> K-UTILS PRO
        </div>
        
        <ul class="nav-menu">
            <li><a href="#intro" class="nav-link active"><i class="fas fa-home"></i> <span class="lang-vi">Gi·ªõi thi·ªáu</span><span class="lang-en">Intro</span></a></li>
            <li><a href="#download" class="nav-link" style="color: var(--primary); font-weight: 600;"><i class="fas fa-cloud-download-alt"></i> <span class="lang-vi">T·∫£i b·ªô c√†i</span><span class="lang-en">Download</span></a></li>
            <li><a href="#finance" class="nav-link"><i class="fas fa-coins"></i> <span class="lang-vi">T√†i ch√≠nh</span><span class="lang-en">Finance</span></a></li>
            <li><a href="#data" class="nav-link"><i class="fas fa-database"></i> <span class="lang-vi">X·ª≠ l√Ω D·ªØ li·ªáu</span><span class="lang-en">Data Tools</span></a></li>
            <li><a href="#email" class="nav-link"><i class="fas fa-envelope"></i> <span class="lang-vi">Email Marketing</span><span class="lang-en">Email</span></a></li>
            <li><a href="#donate" class="nav-link"><i class="fas fa-coffee"></i> <span class="lang-vi">M·ªùi Cafe</span><span class="lang-en">Donate</span></a></li>
        </ul>
    </aside>

    <main class="main-content">
        <section id="intro">
            <h1>K-Utils PRO v2.2.0 <span class="badge">New</span></h1>
            <div class="lang-vi">
                <p>Add-in Excel to√†n di·ªán d√†nh cho K·∫ø to√°n, H√†nh ch√≠nh v√† Nh√¢n s·ª±. T·ª± ƒë·ªông h√≥a c√°c t√°c v·ª• l·∫∑p l·∫°i, ti·∫øt ki·ªám h√†ng gi·ªù l√†m vi·ªác m·ªói ng√†y.</p>
                <div style="background: rgba(37,99,235,0.1); border-left: 4px solid #2563eb; padding: 15px; border-radius: 4px; margin-top: 20px;">
                    <i class="fas fa-info-circle"></i> <strong>T√≠nh nƒÉng m·ªõi trong v2.2:</strong>
                    <ul>
                        <li>T√πy ch·ªânh gi·ªçng ƒë·ªçc s·ªë (Mi·ªÅn B·∫Øc/Nam, Vi·∫øt hoa).</li>
                        <li>H√†m ƒë·ªçc ngo·∫°i t·ªá b·∫•t k·ª≥ (Y√™n, Euro, T·ªá...).</li>
                        <li>T·ª± ƒë·ªông ki·ªÉm tra c·∫≠p nh·∫≠t & Fix l·ªói k·∫øt n·ªëi.</li>
                    </ul>
                </div>
            </div>
            <div class="lang-en">
                <p>Comprehensive Excel Add-in for Accountants. Version 2.2 introduces advanced number-to-text features.</p>
                <div style="background: rgba(37,99,235,0.1); border-left: 4px solid #2563eb; padding: 15px; border-radius: 4px; margin-top: 20px;">
                    <i class="fas fa-info-circle"></i> <strong>New in v2.2:</strong>
                    <ul>
                        <li>Regional options: North/South accents.</li>
                        <li>Custom currency reading.</li>
                        <li>Auto-update check & bug fixes.</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="download">
            <h2><i class="fas fa-cloud-download-alt"></i> <span class="lang-vi">T·∫£i v·ªÅ</span><span class="lang-en">Download</span></h2>
            <div class="feature-card" style="text-align: center; border-color: var(--primary);">
                <h3>K-UTILS PRO Installer v2.2.0</h3>
                <p class="lang-vi">T·∫£i b·ªô c√†i ƒë·∫∑t (.exe) m·ªõi nh·∫•t t·ª´ Google Drive.</p>
                <p class="lang-en">Download the latest .exe installer from Google Drive.</p>
                <a href="https://drive.google.com/drive/folders/1xHwO7JacMJNvxg8jLfyOdrzhVvDKQKA8" target="_blank" class="download-btn">
                    <i class="fab fa-google-drive"></i> <span class="lang-vi">T·∫£i Ngay (Google Drive)</span><span class="lang-en">Download Now</span>
                </a>
            </div>
        </section>

        <section id="finance">
            <h2><i class="fas fa-coins"></i> <span class="lang-vi">1. T√†i ch√≠nh (ƒê·ªçc s·ªë n√¢ng cao)</span><span class="lang-en">1. Finance</span></h2>
            
            <div class="grid-2">
                <div class="feature-card">
                    <h3><i class="fas fa-font"></i> <span class="lang-vi">H√†m VND (T√πy bi·∫øn)</span><span class="lang-en">VND Function</span></h3>
                    <p class="lang-vi">C√∫ ph√°p: <code>=VND(SoTien, [KieuDoc], [KieuVietHoa])</code></p>
                    <ul class="lang-vi">
                        <li><code>=VND(A1)</code> <br>‚ûù M·ªôt trƒÉm ngh√¨n ƒë·ªìng ch·∫µn.</li>
                        <li><code>=VND(A1, 1)</code> <br>‚ûù M·ªôt trƒÉm <u style="color:red">ng√†n</u> ƒë·ªìng ch·∫µn (Mi·ªÅn Nam).</li>
                        <li><code>=VND(A1, 0, 2)</code> <br>‚ûù M·ªòT TRƒÇM NGH√åN ƒê·ªíNG CH·∫¥N (Vi·∫øt hoa).</li>
                    </ul>
                    <p class="lang-en">Convert numbers to text with Regional and Case options.</p>
                </div>

                <div class="feature-card">
                    <h3><i class="fas fa-globe"></i> <span class="lang-vi">H√†m DOC_TIEN (Ngo·∫°i t·ªá)</span><span class="lang-en">Any Currency</span></h3>
                    <p class="lang-vi">ƒê·ªçc b·∫•t k·ª≥ lo·∫°i ti·ªÅn n√†o b·∫°n mu·ªën.</p>
                    <p><code>=DOC_TIEN(SoTien, "TenTien", "TenLe")</code></p>
                    <ul>
                        <li><code>=DOC_TIEN(10.5, "Euro", "xen")</code><br>‚ûù M∆∞·ªùi Euro v√† nƒÉm m∆∞∆°i xen.</li>
                        <li><code>=DOC_TIEN(500, "Y√™n", "")</code><br>‚ûù NƒÉm trƒÉm Y√™n ch·∫µn.</li>
                    </ul>
                </div>

                <div class="feature-card">
                    <h3><i class="fas fa-search-dollar"></i> <span class="lang-vi">Tra c·ª©u & T·ª∑ gi√°</span><span class="lang-en">Lookup & Rate</span></h3>
                    <p class="lang-vi">K·∫øt n·ªëi tr·ª±c ti·∫øp Server Vietcombank & T·ªïng c·ª•c thu·∫ø.</p>
                    <ul>
                        <li><strong>Ctrl+Shift+M:</strong> Tra c·ª©u T√™n c√¥ng ty t·ª´ MST.</li>
                        <li><strong>Menu Ribbon:</strong> L·∫•y t·ª∑ gi√° b√°n ra hi·ªán t·∫°i.</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="data">
            <h2><i class="fas fa-database"></i> <span class="lang-vi">2. X·ª≠ l√Ω D·ªØ li·ªáu</span><span class="lang-en">2. Data Tools</span></h2>
            <div class="grid-2">
                <div class="feature-card">
                    <h3><i class="fas fa-magic"></i> <span class="lang-vi">H√†m RegEx (M·ªõi)</span><span class="lang-en">RegEx Function</span></h3>
                    <p class="lang-vi">T√°ch d·ªØ li·ªáu kh√≥ nh∆∞ Email, SƒêT t·ª´ chu·ªói vƒÉn b·∫£n h·ªón ƒë·ªôn.</p>
                    <code>=RegExExtract(A1, "\d+")</code>
                </div>
                <div class="feature-card">
                    <h3><i class="fas fa-file-excel"></i> <span class="lang-vi">G·ªôp File Excel</span><span class="lang-en">Merge Files</span></h3>
                    <p class="lang-vi">Gom nhi·ªÅu file Excel trong 1 th∆∞ m·ª•c v√†o file hi·ªán t·∫°i.</p>
                </div>
                <div class="feature-card">
                    <h3><i class="fas fa-broom"></i> <span class="lang-vi">D·ªçn d·∫πp d·ªØ li·ªáu</span><span class="lang-en">Clean Data</span></h3>
                    <p class="lang-vi">X√≥a kho·∫£ng tr·∫Øng c·ª©ng (Char 160) s·ª≠a l·ªói VLOOKUP #N/A. Chu·∫©n h√≥a t√™n ri√™ng.</p>
                </div>
            </div>
        </section>

        <section id="email">
            <h2><i class="fas fa-envelope"></i> <span class="lang-vi">3. Email Marketing</span><span class="lang-en">3. Bulk Email</span></h2>
            <p class="lang-vi">G·ª≠i Email h√†ng lo·∫°t qua Outlook v·ªõi file ƒë√≠nh k√®m ri√™ng bi·ªát cho t·ª´ng ng∆∞·ªùi. R·∫•t ti·ªán ƒë·ªÉ g·ª≠i Phi·∫øu l∆∞∆°ng, Th√¥ng b√°o c√¥ng n·ª£.</p>
            <p class="lang-en">Send bulk emails via Outlook with individual attachments.</p>
            <div style="background: var(--bg-card); border:1px solid var(--border); padding:10px; border-radius:8px; font-size:0.9em;">
                <strong>C·∫•u tr√∫c b·∫£ng (B√¥i ƒëen c·ªôt Email):</strong><br>
                [T√™n] | [Email] | [Ti√™u ƒë·ªÅ] | [N·ªôi dung] | [ƒê∆∞·ªùng d·∫´n File]
            </div>
        </section>

        <section id="donate">
            <div class="donate-wrapper">
                <h2 style="justify-content: center; border: none; font-size: 28px; margin-bottom: 10px;">
                    <i class="fas fa-mug-hot"></i> <span class="lang-vi">M·ªùi t√°c gi·∫£ ly c√† ph√™?</span><span class="lang-en">Buy me a coffee?</span>
                </h2>
                <div class="bank-card">
                    <span class="bank-logo">TECHCOMBANK</span>
                    <div style="margin-bottom: 5px; font-size: 13px; color: #999;">Account Number:</div>
                    <div class="account-number" id="accNum">1907 5093 4460 12</div>
                    <button class="copy-btn" onclick="copyToClipboard()"><i class="far fa-copy"></i> Copy</button>
                    <div style="margin-top: 15px; font-size: 13px; color: #999;">Account Name:</div>
                    <div class="account-name">TRAN TUAN KHOA</div>
                </div>
                <p style="margin-top: 20px; font-size: 14px; color: var(--text-muted);">
                    <i class="fas fa-heart" style="color: #e11d48;"></i> <span class="lang-vi">C·∫£m ∆°n b·∫°n r·∫•t nhi·ªÅu!</span><span class="lang-en">Thank you very much!</span>
                </p>
            </div>
        </section>

        <footer style="text-align: center; margin-top: 50px; padding-top: 20px; border-top: 1px solid var(--border); color: var(--text-muted); font-size: 14px;">
            &copy; 2025 K-Utils PRO. Developed by Tran Tuan Khoa.
        </footer>
    </main>

    <script>
        function copyToClipboard() {
            const accNum = document.getElementById('accNum').innerText.replace(/\s/g, ''); 
            const btn = document.querySelector('.copy-btn');
            const showSuccess = () => {
                btn.innerHTML = '<i class="fas fa-check"></i> Copied';
                btn.style.background = '#10b981'; btn.style.color = 'white'; btn.style.borderColor = '#10b981';
                setTimeout(() => { btn.innerHTML = '<i class="far fa-copy"></i> Copy'; btn.style.background = ''; btn.style.color = ''; btn.style.borderColor = ''; }, 2000);
            };
            // Fallback for non-secure contexts (http/file)
            if (navigator.clipboard && window.isSecureContext) { 
                navigator.clipboard.writeText(accNum).then(showSuccess).catch(() => fallbackCopy(accNum)); 
            } else { 
                fallbackCopy(accNum); 
            }
            function fallbackCopy(text) {
                const ta = document.createElement("textarea"); 
                ta.value = text; 
                ta.style.position = "fixed"; 
                ta.style.left = "-9999px";
                document.body.appendChild(ta); 
                ta.focus(); 
                ta.select();
                try { 
                    if (document.execCommand('copy')) showSuccess(); 
                    else prompt("Ctrl+C ƒë·ªÉ copy:", text); 
                } catch (e) { 
                    prompt("Ctrl+C ƒë·ªÉ copy:", text); 
                }
                document.body.removeChild(ta);
            }
        }

        function toggleTheme() {
            const b = document.body; const i = document.getElementById('theme-icon');
            if (b.getAttribute('data-theme') === 'dark') { b.removeAttribute('data-theme'); i.className = 'fas fa-moon'; localStorage.setItem('theme', 'light'); }
            else { b.setAttribute('data-theme', 'dark'); i.className = 'fas fa-sun'; localStorage.setItem('theme', 'dark'); }
        }

        function toggleLanguage() {
            const t = document.getElementById('lang-text'); const i = document.getElementById('lang-icon');
            const v = document.querySelectorAll('.lang-vi'); const e = document.querySelectorAll('.lang-en');
            let c = localStorage.getItem('lang') || 'vi';
            if (c === 'vi') { 
                v.forEach(x => x.style.display='none'); e.forEach(x => x.style.display='inline'); 
                t.innerText='VN'; i.innerText='üáªüá≥'; localStorage.setItem('lang', 'en'); 
            } else { 
                v.forEach(x => x.style.display='inline'); e.forEach(x => x.style.display='none'); 
                t.innerText='EN'; i.innerText='üá∫üá∏'; localStorage.setItem('lang', 'vi'); 
            }
        }

        function applyLanguage(l) {
            const t = document.getElementById('lang-text'); const i = document.getElementById('lang-icon');
            const v = document.querySelectorAll('.lang-vi'); const e = document.querySelectorAll('.lang-en');
            if (l === 'en') { 
                v.forEach(x => x.style.display='none'); e.forEach(x => x.style.display='inline'); 
                t.innerText='VN'; i.innerText='üáªüá≥'; 
            } else { 
                v.forEach(x => x.style.display='inline'); e.forEach(x => x.style.display='none'); 
                t.innerText='EN'; i.innerText='üá∫üá∏'; 
            }
        }

        document.addEventListener('DOMContentLoaded', () => {
            if (localStorage.getItem('theme') === 'dark') { document.body.setAttribute('data-theme', 'dark'); document.getElementById('theme-icon').className = 'fas fa-sun'; }
            applyLanguage(localStorage.getItem('lang') || 'vi');
        });

        window.addEventListener('scroll', () => {
            const s = document.querySelectorAll('section'); const n = document.querySelectorAll('.nav-link'); let c = '';
            s.forEach(x => { if (pageYOffset >= x.offsetTop - 100) c = x.getAttribute('id'); });
            n.forEach(l => { l.classList.remove('active'); if (l.getAttribute('href').includes(c)) l.classList.add('active'); });
        });
    </script>
</body>
</html>